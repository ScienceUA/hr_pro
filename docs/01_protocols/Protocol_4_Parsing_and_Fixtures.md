# ДЕТАЛЬНЫЙ ПРОТОКОЛ ВЫПОЛНЕНИЯ ПУНКТА 4
Парсинг HTML и контракты данных

## Статус

Пункт 4 выполнен и закрыт.
Модуль парсинга считается финально утверждённым и стабильным.

Источник истины:
- порядок и статус пунктов — `docs/00_context/Development_Plan.md`;
- архитектурные решения пункта 4 — данный протокол.

Зафиксировано:
- парсинг является детерминированным;
- парсинг не содержит агентной логики;
- парсинг не принимает решений о релевантности кандидатов.

---

## 1. Назначение модуля парсинга

Модуль парсинга отвечает за:
- классификацию HTML-страниц Work.ua;
- извлечение структурированных данных;
- валидацию качества результата.

Модуль парсинга **не отвечает** за:
- поиск кандидатов;
- оценку соответствия;
- принятие решений об отборе.

---

## 2. Контракты и модели данных

### 2.1 Файл

- `app/parsing/models.py`

### 2.2 Зафиксированные решения

- строгая типизация данных через Pydantic;
- разделение:
  - PageType (тип страницы),
  - DataQuality (качество результата);
- контейнер ParsingResult, разделяющий метаданные и payload.

Инвариант:
- при страницах доступа или блокировок полезная нагрузка отсутствует.

---

## 3. Реестр селекторов (DOM-конфигурация)

### 3.1 Файл

- `app/parsing/selectors.py`

### 3.2 Зафиксированные решения

- централизованное хранение CSS-селекторов;
- сигнатуры для определения типа страницы;
- фиксированные селекторы для SERP и детальных страниц.

Назначение:
- устойчивость к изменениям DOM;
- отсутствие “магических” селекторов в коде.

---

## 4. Базовый движок парсинга

### 4.1 Файл

- `app/parsing/base.py`

### 4.2 Зафиксированные решения

- разбор HTML через lxml;
- автоматическая классификация страниц;
- нормализация и очистка текста.

---

## 5. Парсер списка резюме (SERP)

### 5.1 Файл

- `app/parsing/serp.py`

### 5.2 Зафиксированные решения

- извлечение ссылок на резюме;
- устойчивость к битым карточкам;
- отсутствие прерывания батча при ошибках отдельных элементов.

---

## 6. Парсер детального резюме

### 6.1 Файл

- `app/parsing/resume.py`

### 6.2 Зафиксированные решения

- канонизация URL резюме;
- изоляция области парсинга;
- секционный разбор по смысловым блокам;
- исключение системных и нерелевантных элементов.

---

## 7. Итоговая фиксация

- Пункт 4 закрыт.
- Контракты данных зафиксированы.
- Парсинг стабилен и воспроизводим.
- Модуль готов к использованию без изменений на последующих этапах.

Протокол закрыт.