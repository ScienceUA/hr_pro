# Development_Plan.md
## Статус документа (SOURCE OF TRUTH)
Этот документ является **единственным источником истины** для:
- порядка разработки проекта HR-Pro,
- состава этапов,
- их статусов,
- допустимых и запрещённых изменений.
Если README.md, handoff-документы или любые другие тексты противоречат этому файлу,
приоритет всегда имеет **Development_Plan.md**.
Любые изменения этого документа допускаются **только по явному согласованию**.
---
## Нотация и правила
Используется **одна-единственная нотация**:
- Основные пункты: 1, 2, 3, …
- Подпункты: 1.1, 1.2, …
- При необходимости: 1.1.1, 1.1.2
**Других схем нумерации не существует и использоваться не может.**
Правило неизменности:
- Завершённый пункт считается закрытым.
- Рефакторинг или изменение архитектуры закрытых пунктов запрещены без отдельного решения.
Жёстко зафиксированный порядок усложнения проекта:
**Local MVP → Agent Logic → Cloud → Proxy**
---
Ниже приведён детальный план разработки проекта.
Пункты выполняются строго по порядку.
Пропуск, перестановка или параллельное выполнение этапов запрещены.
---
## План разработки
### 1. Инициализация окружения
Цель: подготовить локальную среду и базовую структуру проекта.
1.1 Настройка IDE и инструментов разработки  
1.2 Установка и настройка Python 3.11  
1.3 Создание базовой структуры проекта (`app/`, конфигурационные файлы, entry-point)
Статус: ✅ завершено
---
### 2. Контракты данных
Цель: зафиксировать структуры данных и форматы ошибок.
2.1 Pydantic-схемы доменных сущностей  
2.2 Статусы обработки (ok / partial / failed)  
2.3 Структуры ошибок и диагностических сообщений
Статус: ✅ завершено
---
### 3. Транспорт и подготовительный Resilient HTTP
Цель: иметь транспортный слой, пригодный для будущего усложнения,
**не меняя runtime Local MVP**.
3.1 Контракт Fetcher: `get(url) -> str`  
3.2 Эталонная реализация транспорта для Local MVP:
- SmartFetcher
- синхронный
- `requests`
- headers / User-Agent rotation
- **без прокси**
3.3 Resilient HTTP как подготовительный задел:
- jitter / backoff
- классификация ошибок (429 / 403 / network)
- возможная async-реализация (httpx + tenacity)
- подключение в будущем через адаптер
- **НЕ используется в runtime Local MVP**
Статус: ✅ завершено
---
### 4. Парсинг резюме и тестирование
Цель: стабильный, воспроизводимый парсинг.

4.1 Парсер детального резюме  
4.2 Валидация полноты и качества извлечённых данных  
4.3 HTML-фикстуры и инструменты их обновления
Статус: ✅ завершено
---
### 5. Локальный оркестратор (Service Layer). Local MVP
Цель: собрать полностью рабочий локальный продукт полного цикла сбора данных.
5.1 Service Layer объединяет Fetcher и Parsers в единый пайплайн  
5.2 Исполняемый сценарий (например, `main.py`):
- принимает поисковый запрос,
- ходит по пагинации,
- собирает ссылки на резюме,
- загружает детали,
- сохраняет результат в JSON / JSONL.
Границы этапа:
- используется Fetcher-интерфейс
- эталонный Fetcher — SmartFetcher
- **без прокси**
- **без Resilient HTTP в runtime**
Статус: ✅ завершено  
Проект находится в состоянии **готового Local MVP**
---
### 6. Логика Агента и AI-анализ (ТЕКУЩИЙ ЭТАП)
Цель: добавить смысл и управление поиском,
**не вмешиваясь в сбор данных**.
6.1 Интерпретация запроса пользователя  
- вход: сырой текст вакансии / критериев
- разделение критериев на:
  - обязательные (переводимые в фильтры поиска),
  - опциональные (soft skills, контекст, поведенческие маркеры)
6.2 Формирование команды парсеру  
- обязательные критерии → структурированная команда
- запуск существующего Local MVP **без изменений транспорта и парсеров**
6.3 Семантический анализ резюме  
- анализ по опциональным критериям
- учёт лимитов токенов и батчинга
- формирование оценок и ранжирования
6.4 Выходной артефакт  
- shortlist
- объяснение соответствия
- ссылки на резюме на источнике
Ограничения этапа:
- запрещено менять Local MVP
- запрещено добавлять прокси
- запрещено начинать cloud
Статус: ⏳ активный этап
---
### 7. Контейнеризация и миграция в облако
Цель: перенести **уже работающую** систему в облако без изменения логики.
7.1 Dockerfile и локальная сборка  
7.2 Инфраструктура GCP (очереди / хранилище / БД)  
7.3 Деплой (например, Cloud Run)
Ограничение:
- выполняется только после завершения пункта 6
Статус: ⏸ запланировано
---
### 8. Proxy-aware Orchestration
Цель: масштабирование и обход блокировок.
8.1 ProxyManager: pool / rotation / quarantine  
8.2 Политики смены IP при 403 / ProxyError / ConnectError  
8.3 Раздельные лимиты: прокси vs URL
Ограничение:
- выполняется только после завершения пункта 7
Статус: ⏸ запланировано
