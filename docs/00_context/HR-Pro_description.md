# HR-Pro: целостное описание системы

## Навигация по документации

Этот документ описывает систему целостно и без дублирования деталей реализации. Углублённые решения и протоколы описаны в связанных документах:

- `README.md` — краткое вводное описание системы.
- `docs/00_context/Development_Plan.md` — единственный источник истины по порядку работ и фиксированным границам пунктов.
- `docs/02_handoff/DECISIONS.md` — зафиксированные решения, которые нельзя менять без явного согласования.
- `docs/02_handoff/STATUS.md` — текущее состояние выполнения (что закрыто, что активно).
- `docs/02_handoff/NEXT_AGENT.md` — инструкция следующему агенту: что делать дальше и какие ограничения соблюдать.

Протоколы реализации (детальные решения по закрытым пунктам):
- `docs/01_protocols/Protocol_3_Resilient_HTTP.md`
- `docs/01_protocols/Protocol_4_Parsing_and_Fixtures.md`
- `docs/01_protocols/Protocol_5_Local_Orchestrator_MVP.md`

Если возникает расхождение между описанием и решениями/протоколами, приоритет имеют:
1) `docs/00_context/Development_Plan.md`, затем  
2) `docs/02_handoff/DECISIONS.md`, затем  
3) протоколы пунктов, затем  
4) этот документ.

## 1. Назначение

HR-Pro — система для автоматизации поиска и анализа резюме на Work.ua под конкретный запрос рекрутера.

Система:
- принимает запрос рекрутера в свободной форме;
- преобразует запрос в структурированную команду на поиск;
- получает резюме из выдачи Work.ua;
- выполняет смысловое сопоставление резюме с требованиями вакансии;
- возвращает рекрутеру:
  - ссылки на резюме на Work.ua,
  - оценку соответствия,
  - краткое объяснение сильных/слабых сторон относительно заданных критериев.

Проект учебный/личный:
- без перепродажи данных;
- без публичной публикации резюме;
- без построения конкурирующей базы резюме.

## 2. Ключевые ограничения и принципы

2.1 Ограничения по данным кандидатов
- система не использует ФИО, контакты и иные персональные идентификаторы как данные для анализа или результата;
- результат для пользователя опирается на ссылку на оригинал резюме на Work.ua и краткое заключение.

2.2 Этический режим доступа к источнику
- система работает в «мягком» режиме запросов (throttling), чтобы не перегружать источник;
- система не предназначена для массового выгружания данных и построения постоянного хранилища резюме.

2.3 Принцип разделения ответственности
- транспорт отвечает только за получение HTML;
- парсинг отвечает только за извлечение структурированных данных и классификацию страниц;
- оркестратор отвечает за порядок шагов и сохранение артефактов выполнения;
- агент отвечает за смысл: постановку задачи, формирование команды на поиск и финальный анализ.

## 3. Компоненты системы

Система состоит из трёх логических компонентов.

3.1 Агент (интерфейс и “мозг” системы)
Роль:
- принять запрос рекрутера в свободной форме;
- уточнить недостающие критерии;
- разделить критерии на обязательные и опциональные;
- сформировать структурированную команду на поиск;
- получить результаты парсинга;
- выполнить семантический анализ и ранжирование;
- сформировать результат для пользователя.

3.2 Исполнитель (crawler/parsing/service layer)
Роль:
- детерминированно собрать данные по команде агента;
- извлечь структурированные данные из HTML;
- сохранить результат выполнения в JSON/JSONL.

3.3 Конфигурация фильтров Work.ua
Роль:
- единый источник соответствия человеческих критериев и параметров Work.ua.

## 4. Контракты и границы модулей

4.1 Контракт Fetcher
Fetcher возвращает HTML строкой: `get(url) -> str`.
Fetcher не классифицирует тип страницы и не принимает доменных решений.

4.2 Контракт ParsingResult
Парсинг возвращает контейнер результата с метаданными и payload.
Для страниц доступа/блокировок payload отсутствует.

4.3 Классификация PageType
Парсер различает SERP, RESUME, LOGIN/CAPTCHA/BAN, NOT_FOUND.

## 5. Сквозной сценарий работы (без инфраструктурных деталей)

5.1 Формирование команды
Агент принимает сырой запрос, извлекает критерии и формирует команду исполнителю.

5.2 Поиск и сбор данных
Исполнитель строит каноничный поисковый URL, получает SERP, извлекает ссылки, загружает детали и сохраняет результаты.

5.3 Семантический анализ и результат
Агент анализирует резюме по опциональным критериям и формирует shortlist с оценками и объяснением.

## 6. Технологические допущения

- основной язык реализации: Python 3.11;
- парсинг: HTML → структурированные DTO (Pydantic);
- транспорт в локальном исполнителе: синхронный fetcher на базе requests;
- асинхронный resilient-транспорт и прокси-оркестрация рассматриваются как отдельные подсистемы, не меняющие контрактов Fetcher и ParsingResult.

## 7. Итоговая фиксация

HR-Pro — агентно-управляемая система подбора кандидатов, где:
- исполнитель обеспечивает детерминированный сбор данных с Work.ua по команде агента;
- агент обеспечивает постановку задачи, управление поиском и семантический анализ;
- контракты Fetcher и ParsingResult являются ключевыми инвариантами архитектуры;
- результат для пользователя — ссылки на источник + оценка и объяснение соответствия.